<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta content="width=500" name="viewport">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
  <title>WiFi Settings</title>
  <script>
    const d = document;
    let loc = false, locip;

    function cE(e) {
      return d.createElement(e);
    }

    function H() {
      window.open("https://kno.wled.ge/features/settings/#wifi-settings");
    }

    function B() {
      window.open("/settings.html", "_self");
    }

    // https://www.educative.io/edpresso/how-to-dynamically-load-a-js-file-in-javascript
    function loadJS(FILE_URL, async = true) {
      let scE = cE("script");
      scE.setAttribute("src", FILE_URL);
      scE.setAttribute("type", "text/javascript");
      scE.setAttribute("async", async);
      d.body.appendChild(scE);
      // success event
      scE.addEventListener("load", () => {
        //console.log("File loaded");
        GetV();
      });
      // error event
      scE.addEventListener("error", (ev) => {
        console.log("Error on loading file", ev);
        alert("Loading of configuration script failed.\nIncomplete page data!");
      });
    }

    function S() {
      const url = (loc ? `http://${locip}` : '') + '/settings/s.js?p=1';
      loadJS(url, false);	// If we set async false, file is loaded and executed, then next statement is processed
    }
  </script>
</head>
<body onload="S()">
<div class="w-full max-w-3xl">
  <form class="bg-white shadow-md roundex px-8 pt-6 pb-8 mb-4" id="form_s"

        method="post" name="Sf">
    <div class="toprow">
      <button onclick="B()" type="button">Back</button>
    </div>
    <h2 class="mb-6 text-lg font-bold text-gray-500">WiFi setup</h2>
    <fieldset class="mb-4">
      <hyd-m-wifi-ssid-picker></hyd-m-wifi-ssid-picker>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="CP">
          Network password
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
               id="CP"
               name="CP"
               placeholder="******************" type="password">
      </div>
      <fieldset class="mb-4">
        <legend class="block text-gray-700 text-sm font-bold mb-2">Static IP (leave at 0.0.0.0 for DHCP)</legend>
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="I0" required type="number"> .
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="I1" required type="number"> .
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="I2" required type="number"> .
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="I3" required type="number">
      </fieldset>
      <fieldset class="mb-4">
        <legend class="block text-gray-700 text-sm font-bold mb-2">Static gateway</legend>
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="G0" required type="number"> .
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="G1" required type="number"> .
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="G2" required type="number"> .
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="G3" required type="number">
      </fieldset>
      <fieldset class="mb-4">
        <legend class="block text-gray-700 text-sm font-bold mb-2">Static subnet mask</legend>
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="S0" required type="number"> .
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="S1" required type="number"> .
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="S2" required type="number"> .
        <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" max="255" min="0"
               name="S3" required type="number">
      </fieldset>

      mDNS address (leave empty for no mDNS):<br>
      http:// <input maxlength="32" name="CM" type="text"> .local<br>
      Client IP: <span class="sip"> Not connected </span> <br>
    </fieldset>
    <h2 class="mb-6 text-lg font-bold text-gray-500">Configure Access Point</h2>
    <fieldset class="mb-4">
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="AS">
          AP SSID (leave empty for no AP)
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
               id="AS"
               name="AS"
               placeholder="SSID" type="text">
      </div>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="AP">
          AP password (leave empty for open)
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
               id="AP"
               name="AP"
               pattern="(.{8,63})|()" placeholder="******************"
               type="password"
        >
      </div>
      <div class="md:flex mb-6">
        <label class="md:w-2/3 block text-gray-500 font-bold">
          <input class="mr-2 leading-tight" id="AH" name="AH" type="checkbox">
          <span class="text-sm">
        Hide AP name
      </span>
        </label>
      </div>
    </fieldset>
    <div class="mb-4">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="AC">
        Access Point WiFi channel
      </label>
      <input class="shadow appearance-none border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
             id="AC"
             max="13"
             min="1"
             name="AC"
             required type="number">
    </div>
    <div class="mb-4">
      <label class="block text-gray-700 text-sm font-bold mb-2" for="AB">
        AP opens
      </label>
      <div class="relative">
        <select
            class="shadow border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
            id="AB" name="AB">
          <option value="0">No connection after boot</option>
          <option value="1">Disconnected</option>
          <option value="2">Always</option>
          <option value="3">Never (not recommended)</option>
        </select>
      </div>
    </div>
    AP IP: <span class="sip"> Not active </span><br>
    <button class="shadow bg-purple-500 hover:bg-purple-400 focus:shadow-outline focus:outline-none text-white font-bold py-2 px-4 rounded" type="submit">
      Save & Connect
    </button>
  </form>
</div>
</body>
</html>

